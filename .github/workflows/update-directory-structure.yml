name: update directory structure in readme

on:
    push:
        branches:
            - main


jobs:
    generate-markdown:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v4
            
            - name: Set up Python
              uses: actions/setup-python@v4
              with:
                python-version: '3.10'
            
            - name: Run script
              run: |
                python readme_generator.py
            
            - name: Commit and push changes
              env:
                 GITHUB_TOKEN: ${{ secrets.ACTIONS_TOKEN }}
              run: |
                git config user.name "GitHub Actions"
                git config user.email "actions@github.com"

                git add README.md

                git commit -m "updated directory structure at $(date -u +'%Y-%m-%d %H:%M:%S') [skip ci]"
                
                echo "GITHUB_TOKEN: ${{ secrets.ACTIONS_TOKEN }}"
                echo "GITHUB_REPOSITORY: ${{ github.repository }}"
                git push https://x-access-token:${{ secrets.ACTIONS_TOKEN }}@github.com/${{ github.repository }}.git HEAD:main
                  