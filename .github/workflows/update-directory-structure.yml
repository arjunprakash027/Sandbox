name: update directory structure in readme

on:
    push:
        branches:
            - main


jobs:
    generate-markdown:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v3
            
            - name: Set up Python
              uses: actions/setup-python@v4
              with:
                python-version: '3.10'
            
            - name: Run script
              run: |
                python readme_generator.py
            
            - name: Commit and push changes
              env:
                 GITHUB_TOKEN: ${{ secrets.ACTIONS_TOKEN }}
              run: |
                git config --global user.name "github-actions[bot]"
                git config --global user.email "github-actions[bot]@users.noreply.github.com"

                git add README.md

                git commit -m "updated directory structure at $(date -u +'%Y-%m-%d %H:%M:%S') [skip ci]"
                
                git remote set-url origin https://x-access-token:${{ secrets.ACTIONS_TOKEN }}@github.com/${{ github.repository }}.git
                git push origin HEAD:main
                  